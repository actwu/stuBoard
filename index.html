<style>
body { all: none; color: #fff; }
section { display: grid; margin: 3.5px; gap: 3.5px; grid-template-columns: repeat(auto-fill, minmax(128px, 0.8fr)); max-height: 400px; }
textarea { text-align: center; height: 0.235in; }
textarea:first-of-type, textarea:nth-of-type(5), textarea:nth-of-type(6), p, a { grid-column: span 2; }
textarea:nth-of-type(2), textarea:nth-of-type(3), textarea:nth-of-type(4) { grid-column: span 1; }
p { text-align: center; border: 0; }
[scroll]{ overflow-y: auto; }
</style>
<warn>This is visible because ise haven't run yet.</warn>
<setup>
set.title('Student Dashboard');
set.info('Manage student subjects and data');
set.key('student, dashboard, management');
set.view();
set.cover(1);
set.icon(1);
ui();
</setup>
<script src='https://ise.web.app/load.js'></script>
<body>
<cont top bar bbg center fixed><p id="clock"></p></cont>
<screen id="classes" center>
<div id="clsList" flex></div>
<a bdr="0" bbg2 onclick="addCls()">Add Class</a>
</screen>
<screen id="clsInfo" hide scroll center>
<nav bbg bdr="0">
<a onclick="show('#classes'); hide('#clsInfo')">Back</a>
<a bdr="0" bbg2 onclick="shareCls()"><i class="fas fa-share-alt"></i></a>
<a bdr="0" bbg2 item no-m onmousedown="addPnt()" bol2><i class="fas fa-plus"></i></a>
</nav>
<section id="clsDetails" data-cls-id="">
<textarea id="stdName" bol2 type="text" oninput="saveData()" placeholder="Student Name" no-m bdr="0"></textarea>
<textarea id="tchrName" bol2 type="text" oninput="saveData()" placeholder="Teacher Name" no-m bdr="0"></textarea>
<textarea id="clsTime" bol2 type="text" oninput="saveData()" placeholder="Time" no-m bdr="0"></textarea>
<textarea id="tchrEmail" bol2 type="text" oninput="saveData()" placeholder="Teacher Email" no-m bdr="0"></textarea>
<select id="subType" bol2 oninput="saveData()" no-m bdr="0">
<option value="Major">Major</option>
<option value="Minor">Minor</option>
</select>
<textarea id="clsCode" bol2 type="text" oninput="saveData()" placeholder="Class Code" no-m bdr="0"></textarea>
<textarea id="clsDetails" bol2 mid type="text" oninput="saveData()" placeholder="Details" no-m bdr="0"></textarea>
<p id="totalPnts">Points: 0</p>
</section>
</screen>
<script>
const clsData = JSON.parse(localStorage.getItem('clsData')) || {};
const saveData = () => {
const clsId = document.querySelector('#clsDetails').dataset.clsId;
if (!clsId) return;
const data = {
stdName: document.querySelector('#stdName').value,
tchrName: document.querySelector('#tchrName').value,
clsTime: document.querySelector('#clsTime').value,
tchrEmail: document.querySelector('#tchrEmail').value,
subType: document.querySelector('#subType').value,
clsCode: document.querySelector('#clsCode').value,
clsDetails: document.querySelector('#clsDetails').value,
points: []
};
document.querySelectorAll('section p.pnt').forEach(pnt => {
data.points.push({ pntValue: pnt.textContent });
});
clsData[clsId] = data;
localStorage.setItem('clsData', JSON.stringify(clsData));
};

const loadAllCls = () => {
for (const [clsId, data] of Object.entries(clsData)) {
addCls(clsId, data);
}
};

const addPnt = () => {
const pointsSection = document.querySelector('section');
const date = new Date().toLocaleString();
const pnt = document.createElement('p');
pnt.setAttribute('bol2', '');
pnt.setAttribute('bdr', '0');
pnt.classList.add('pnt');
pnt.textContent = `1 - ${date}`;
pointsSection.appendChild(pnt);
pnt.addEventListener('contextmenu', (e) => {
e.preventDefault();
pnt.remove();
updatePnts();
saveData();
});
updatePnts();
saveData();
};

const updatePnts = () => {
const total = document.querySelectorAll('section p.pnt').length;
document.getElementById('totalPnts').textContent = `Points: ${total}`;
};

const shareCls = () => {
const url = new URL(window.location);
url.searchParams.set('data', JSON.stringify(clsData));
navigator.clipboard.writeText(url.toString()).then(() => {
alert('Data shared via URL!');
});
};

const addCls = (clsId = Date.now().toString(), data = {}) => {
const clsList = document.getElementById('clsList');
const clsItem = document.createElement('a');
clsItem.textContent = `Class ${clsList.children.length + 1}`;
clsItem.setAttribute('bol2', '');
clsItem.setAttribute('bdr', '0');
clsItem.onclick = () => {
show('#clsInfo');
hide('#classes');
loadClsData(clsId, data);
};
clsItem.addEventListener('contextmenu', (e) => {
e.preventDefault();
clsItem.remove();
delete clsData[clsId];
localStorage.setItem('clsData', JSON.stringify(clsData));
});
clsList.appendChild(clsItem);
};

const loadClsData = (clsId, data) => {
document.querySelector('#clsDetails').dataset.clsId = clsId;
document.querySelector('#stdName').value = data.stdName || '';
document.querySelector('#tchrName').value = data.tchrName || '';
document.querySelector('#clsTime').value = data.clsTime || '';
document.querySelector('#tchrEmail').value = data.tchrEmail || '';
document.querySelector('#subType').value = data.subType || 'Major';
document.querySelector('#clsCode').value = data.clsCode || '';
document.querySelector('#clsDetails').value = data.clsDetails || '';
document.querySelectorAll('section p.pnt').forEach(p => p.remove());
data.points.forEach(point => {
const pnt = document.createElement('p');
pnt.setAttribute('bol2', '');
pnt.setAttribute('bdr', '0');
pnt.classList.add('pnt');
pnt.textContent = point.pntValue;
document.querySelector('section').appendChild(pnt);
pnt.addEventListener('contextmenu', (e) => {
e.preventDefault();
pnt.remove();
updatePnts();
saveData();
});
});
updatePnts();
};

const loadDataFromUrl = () => {
const urlParams = new URLSearchParams(window.location.search);
if (urlParams.has('data')) {
const data = JSON.parse(urlParams.get('data'));
for (const [clsId, clsInfo] of Object.entries(data)) {
addCls(clsId, clsInfo);
}
}
};

const updateClock = () => {
const now = new Date();
const hours = String(now.getHours()).padStart(2, '0');
const minutes = String(now.getMinutes()).padStart(2, '0');
document.getElementById('clock').textContent = `${hours}:${minutes}`;
};

window.onload = () => {
loadAllCls();
loadDataFromUrl();
show('#classes');
hide('#clsInfo');
setInterval(updateClock, 1000);
};
</script>
</body>
